<aura:component
  controller="BoatReviews"
  implements="flexipage:availableForAllPageTypes"
  access="global"
>
  <aura:attribute name="boat" type="Boat__c" />
  <aura:attribute name="boatReviews" type="BoatReview__c[]" access="private" />
  <aura:handler name="init" value="{!this}" action="{!c.doInit}" />
  <aura:method name="refresh" action="{!c.doInit}" />
  <aura:handler name="change" value="{!v.boat}" action="{!c.doInit}" />

  <ui:scrollerWrapper class="scrollerSize">
    <div class="slds-feed">
      <ul class="slds-feed__list">
        <aura:iteration items="{!v.boatReviews}" var="boatReview">
          <li class="slds_feed__item">
            <article class="slds-post">
              <header class="slds-post__header slds-media">
                <div class="slds-media__figure">
                  <a
                    href="javascript:void(0);"
                    class="slds-avatar slds-avatar_circle"
                  >
                    <img
                      alt="{!boatReview.CreatedBy.Name}"
                      src="{!boatReview.CreatedBy.SmallPhotoUrl}"
                      title="{!boatReview.CreatedBy.Name}"
                    />
                  </a>
                </div>
                <div class="sls-media__body">
                  <div
                    class="slds-grid slds-grid_align-spread slds-has-flexi-truncate"
                  >
                    <p>
                      <a
                        href="javascript:void(0);"
                        title="{!boatReview.CreatedBy.Name}"
                        data-userid="{!boatReview.CreatedBy.Id}"
                        onclick="{!c.onUserInfoClick}"
                        >{!boatReview.CreatedBy.Name}</a
                      >
                      <aura:if isTrue="{!boatReview.CreatedBy.CompanyName}">
                        â€” {!boatReview.CreatedBy.CompanyName}
                      </aura:if>
                    </p>
                  </div>
                  <p class="slds-text-body_small">
                    <lightning:formattedDateTime
                      value="{!boatReview.CreatedDate}"
                      year="numeric"
                      day="2-digit"
                      month="long"
                    />
                    &nbsp;
                    <lightning:formattedDateTime
                      value="{!boatReview.CreatedDate}"
                      hour="2-digit"
                      minute="2-digit"
                      second="2-digit"
                    />
                  </p>
                </div>
              </header>
              <div class="slds-post__content slds-text-longform">
                <p>
                  <lightning:formattedText value="{!boatReview.Name}" />
                  <lightning:formattedRichText
                    value="{!boatReview.Comment__c}"
                  />
                </p>
              </div>
              <c:FiveStarRating
                value="{!boatReview.Rating__c}"
                readonly="true"
              />
            </article>
          </li>
        </aura:iteration>
      </ul>
    </div>
    <aura:if isTrue="{!v.boatReviews.length ==0}">
      <div class="slds-align_absolute-center">
        No reviews available
      </div>
    </aura:if>
  </ui:scrollerWrapper>
</aura:component>